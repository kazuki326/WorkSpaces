# WorkSpace3: LINE注文機能

<!-- このファイルは workspace.json から自動生成されています -->
<!-- 編集する場合は workspace.json を更新してください -->

## 概要

LINE上で商品を検索・注文できるチャットボット機能を実装

## 目的・背景

ECサイト「bier.jp」の公式LINEアカウントにチャットボットを導入し、ユーザーがLINE上で商品を注文できる仕組みを構築する。これにより、ユーザー体験の向上と売上増加を目指す。

### 解決する課題

- ユーザーがWebサイトを訪問せずにLINE上で商品を検索・注文できるようにする
- 既存顧客とのコミュニケーションチャネルを強化する
- 購買プロセスの簡略化による売上増加

### 期待される効果

- ユーザー体験の向上（LINE上で完結する買い物体験）
- 売上増加（購買ハードルの低下）
- 顧客エンゲージメントの向上

<!-- AUTO-GENERATED-START -->
<!-- この部分は workspace.json から自動生成されます。手動で編集しないでください -->
## 📊 進捗状況

| 項目 | 内容 |
|------|------|
| **ステータス** | In Progress 🔧 |
| **進捗率** | 70% |
| **優先度** | High 🔴 |
| **担当者** | 未定 |
| **作成日** | 2024-09-20 |
| **最終更新** | 2024-11-15 |

**タグ**: `LINE` `チャットボット` `GAS` `API` `Flex Message`

### マイルストーン

- [x] アーキテクチャ設計完了 (2024-10-15)
- [ ] GASチャットボット実装 (期限: 2024-11-30)
- [ ] 買い物かごAPI開発 (期限: 2024-12-10)
- [ ] テスト・デバッグ (期限: 2024-12-20)

## 🔗 関連リンク

- [ドキュメント](docs/)
- [プロトタイプを見る](./preview/product_card_preview.html)

## 🎨 プロトタイプ

| プロトタイプ | バージョン | ステータス | 説明 |
|------------|-----------|----------|------|
| [商品カード（Flex Message）](./preview/product_card_preview.html) | v1.0 | ✅ Ready | LINE上で表示する商品カードのUIプレビュー |
| [リッチメニュー](./preview/rich_menu_preview.html) | v1.0 | ✅ Ready | LINEトーク画面下部に表示されるリッチメニューのデザイン |

<!-- AUTO-GENERATED-END -->

## 技術スタック

- **LINE Messaging API**: Webhookによるメッセージ受信・送信
- **Google Apps Script (GAS)**: チャットボットのバックエンド処理
- **Flex Message**: リッチなUIでの商品カード表示
- **bier.jp API**: 買い物かご連携用のカスタムAPI

## アーキテクチャ概要

Miroでの議論の結果、以下のアーキテクチャを採用する。

1.  **LINEチャットボット (Google Apps Script)**:
    *   ユーザーとの対話、商品レコメンドを担当する。
    *   LINE Messaging APIからのWebhookを受け取り、応答メッセージを生成する。

2.  **商品カード (Flex Message)**:
    *   チャットボットが商品を提案する際に、画像、説明、価格、アクションボタンを含むリッチなUI（商品カード）を送信する。

3.  **買い物かご追加API (`bier.jp`側)**:
    *   `bier.jp`のドメイン上に、外部から商品IDを受け取り、localStorageで管理されている買い物かごに商品を追加するためのAPIエンドポイントを新規に開発する。
    *   LINEの商品カードの「商品かごに追加」ボタンは、このAPIを呼び出すURLを指す。

4.  **決済と配送**:
    *   決済と配送先情報の入力は、既存の`bier.jp`のフローを利用する。ユーザーは買い物かごページに遷移し、そこで手続きを完了させる。

**補足:** 当初、LINE内での決済完結も検討されたが（L Message, Lea等の外部サービス利用）、既存の`bier.jp`のシステムとの連携の複雑さや在庫管理の二重化リスクを考慮し、まずは`bier.jp`サイトへの誘導とAPI連携を優先する方針とする。

## 主要機能

- **チャットボットによる商品検索・推薦**: ユーザーのメッセージに基づき、商品を検索し、商品カードを送信する。
- **LINEアカウント連携**: `bier.jp`のアカウントとLINEアカウントを連携させ、シームレスな顧客体験を提供する。
- **リッチメニューの設置**: ユーザーがいつでも「買い物かご」や「トップページ」にアクセスできるメニューをLINEのトーク画面下部に常時表示する。
- **買い物かごへの追加機能**: LINEの商品カードからワンタップで`bier.jp`の買い物かごに商品を追加できる。

## ファイル構成

```
WorkSpace3_line-ordering/
├── README.md              # このファイル
├── workspace.json         # ワークスペース設定
├── docs/                  # ドキュメント
├── preview/               # プロトタイプ
│   ├── product_card_preview.html   # 商品カードプレビュー
│   └── rich_menu_preview.html      # リッチメニュープレビュー
└── src/                   # ソースコード
    └── gas/               # Google Apps Script
```

## TODO

- **`bier.jp`買い物かごAPIの開発**:
    - `bier.jp`のドメインで、商品IDをパラメータとして受け取り、localStorageの買い物かご情報を更新するAPIを実装する。
    - セキュリティ（CSRF対策など）を考慮する必要がある。
- **Google Apps Script (GAS) の実装**:
    - LINE Messaging APIのWebhook処理
    - 商品検索ロジック (`searchByProductName`)
    - 商品カード生成ロジック (`ConvertToProductCard`)
    - `bier.jp`の在庫情報や商品情報をGASから参照する方法の確立（SpreadsheetまたはAPI経由）
- **Flex Messageの最適化**:
    - 商品説明が長文の場合の省略表示 (`...`)
    - 画像のアスペクト比や表示品質の改善
- **LINEアカウント連携の実装**:
    - LINEのドキュメントに基づき、連携フローを設計・実装する。
- **エラーハンドリング**:
    - API呼び出しの失敗、商品が見つからない場合など、様々なエラーケースを想定した処理を実装する。

## メモ

### マーケティング施策

- LINE友だち登録を促進するためのWebサイト上のバナー設置やSNSでの告知。
- クーポン配布、新商品情報、セール情報などを通じたアクティブな情報発信。

---

**[← ダッシュボードに戻る](../index.html)**
