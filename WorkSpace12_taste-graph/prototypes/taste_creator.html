<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>マイテイスト登録</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 20px; background-color: #f4f4f4; }
        h1, h2, h3 { color: #333; }
        .main-container { max-width: 500px; margin: auto; background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .chart-container { width: 100%; max-width: 400px; margin: 20px auto; }
        .sliders { display: flex; flex-direction: column; align-items: center; gap: 10px; margin-top: 20px; }
        .slider-container { display: grid; grid-template-columns: 60px 1fr 30px; align-items: center; width: 100%; max-width: 350px; }
        input[type="range"] { width: 100%; }
        button { background-color: #3e8e41; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; margin-top: 20px; }
        button:hover { background-color: #2c6b2e; }
        #savedTaste { background-color: #eef; padding: 10px; border-radius: 5px; margin-top: 10px; }
    </style>
</head>
<body>
    <div class="main-container">
        <h1>マイテイスト登録</h1>
        <p>スライダーを動かして、あなたの理想の味のグラフを作成・保存できます。</p>
        
        <div class="chart-container">
            <canvas id="tasteChart"></canvas>
        </div>

        <div class="sliders">
            <div class="slider-container"><span>酸味:</span><input type="range" id="sour" min="0" max="5" step="0.5" value="3" oninput="updateChart()"><span id="sour-value">3</span></div>
            <div class="slider-container"><span>甘み:</span><input type="range" id="sweet" min="0" max="5" step="0.5" value="3" oninput="updateChart()"><span id="sweet-value">3</span></div>
            <div class="slider-container"><span>苦み:</span><input type="range" id="bitter" min="0" max="5" step="0.5" value="3" oninput="updateChart()"><span id="bitter-value">3</span></div>
            <div class="slider-container"><span>コク:</span><input type="range" id="body" min="0" max="5" step="0.5" value="3" oninput="updateChart()"><span id="body-value">3</span></div>
            <div class="slider-container"><span>香り:</span><input type="range" id="aroma" min="0" max="5" step="0.5" value="3" oninput="updateChart()"><span id="aroma-value">3</span></div>
        </div>
        
        <button onclick="saveTasteProfile()">マイテイストを保存</button>
        <h3>保存されたマイテイスト</h3>
        <p id="savedTaste">まだ保存されていません。</p>
    </div>

    <script>
        let tasteChart;
        const labels = ["酸味", "甘み", "苦み", "コク", "香り"];
        const ids = ["sour", "sweet", "bitter", "body", "aroma"];

        function updateChart() {
            const data = ids.map(id => {
                const value = document.getElementById(id).value;
                document.getElementById(`${id}-value`).textContent = value;
                return value;
            });
            tasteChart.data.datasets[0].data = data;
            tasteChart.update();
        }
        
        function saveTasteProfile() {
            const tasteProfile = {};
            ids.forEach(id => {
                tasteProfile[id] = document.getElementById(id).value;
            });
            localStorage.setItem("myTaste", JSON.stringify(tasteProfile));
            displaySavedTaste();
            alert("マイテイストを保存しました！");
        }

        function displaySavedTaste() {
            const savedData = localStorage.getItem("myTaste");
            if (savedData) {
                const taste = JSON.parse(savedData);
                document.getElementById("savedTaste").innerText = `酸味: ${taste.sour}, 甘み: ${taste.sweet}, 苦み: ${taste.bitter}, コク: ${taste.body}, 香り: ${taste.aroma}`;
                
                // Update sliders and chart to saved values
                ids.forEach(id => {
                    document.getElementById(id).value = taste[id];
                });
                updateChart();
            }
        }

        window.onload = function() {
            const ctx = document.getElementById("tasteChart").getContext("2d");
            tasteChart = new Chart(ctx, {
                type: "radar",
                data: {
                    labels: labels,
                    datasets: [{
                        label: "マイテイスト",
                        data: [3, 3, 3, 3, 3],
                        fill: true,
                        backgroundColor: "rgba(255, 99, 132, 0.2)",
                        borderColor: "rgba(255, 99, 132, 1)",
                        pointBackgroundColor: "rgba(255, 99, 132, 1)"
                    }]
                },
                options: {
                    scales: { r: { min: 0, max: 5, ticks: { stepSize: 1 } } }
                }
            });
            displaySavedTaste();
            // Initial update for values next to sliders
            ids.forEach(id => {
                document.getElementById(`${id}-value`).textContent = document.getElementById(id).value;
            });
        };
    </script>
</body>
</html>
