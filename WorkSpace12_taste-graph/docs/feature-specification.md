# テイストグラフ機能仕様書

## 概要

テイストグラフ機能は、ビールの味わいを視覚的に表現し、ユーザーが自分の好みを発見・登録し、最適なビールを見つけることをサポートするための機能群です。

本機能群は以下の3つのプロトタイプで構成されています。

---

## プロトタイプA: マイテイスト登録

### 機能概要

ユーザーが自分好みの味のプロファイルをインタラクティブに作成・保存できる機能です。

### 主要機能

| 機能 | 説明 |
|------|------|
| スライダー操作 | 5つの味覚軸（酸味、甘み、苦み、コク、香り）を0-5の範囲で調整 |
| リアルタイムチャート更新 | スライダー操作に連動してレーダーチャートが即座に更新 |
| プロファイル保存 | LocalStorageを使用してマイテイストを永続化 |
| プロファイル復元 | 保存済みプロファイルの自動読み込みとスライダーへの反映 |

### ユースケース

#### UC-A1: 初めてのマイテイスト登録

**アクター**: 新規ユーザー

**事前条件**: マイテイストが未登録

**基本フロー**:
1. ユーザーがマイテイスト登録画面にアクセス
2. 各味覚スライダーを操作して好みを設定
3. レーダーチャートで視覚的に確認
4. 「マイテイストを保存」ボタンをクリック
5. システムがLocalStorageにプロファイルを保存
6. 保存完了のアラートを表示

**事後条件**: マイテイストがLocalStorageに保存される

#### UC-A2: マイテイストの更新

**アクター**: 登録済みユーザー

**事前条件**: マイテイストが登録済み

**基本フロー**:
1. ユーザーがマイテイスト登録画面にアクセス
2. システムが保存済みプロファイルを自動読み込み
3. ユーザーがスライダーで値を変更
4. 「マイテイストを保存」ボタンで上書き保存

### 技術仕様

- **使用ライブラリ**: Chart.js（レーダーチャート）
- **データ永続化**: LocalStorage（キー: `myTaste`）
- **スライダー刻み幅**: 0.5単位

---

## プロトタイプB: ビールマッチング

### 機能概要

ユーザーの味の好みを入力すると、データベース内から最も近い味のビールを提案する機能です。

### 主要機能

| 機能 | 説明 |
|------|------|
| 好み入力 | 5つの味覚軸を数値入力（0-5） |
| マッチング計算 | ユークリッド距離に基づく類似度計算 |
| ビール提案 | 最も距離が近いビールを1件表示 |
| 味覚情報表示 | 提案ビールの各味覚スコアを表示 |

### ユースケース

#### UC-B1: 好みに合うビールを探す

**アクター**: ビール選びに迷っているユーザー

**事前条件**: なし

**基本フロー**:
1. ユーザーが各味覚軸の好みを数値入力
2. 「ビールを提案」ボタンをクリック
3. システムがデータベース内全ビールとの距離を計算
4. 最小距離のビールを特定
5. ビール名と味覚スコアを表示

**事後条件**: おすすめビールが表示される

#### UC-B2: マイテイストからビールを探す（将来拡張）

**アクター**: マイテイスト登録済みユーザー

**事前条件**: マイテイストが登録済み

**基本フロー**:
1. ユーザーがビールマッチング画面にアクセス
2. 「マイテイストを使用」ボタンをクリック
3. 保存済みプロファイルが入力欄に自動反映
4. マッチング実行

### サンプルビールデータベース

現在のプロトタイプには以下のビールが登録されています:

| ビール名 | 酸味 | 甘み | 苦み | コク | 香り |
|----------|------|------|------|------|------|
| ヴァイエンシュテファン ヘフェヴァイスビア | 2 | 3 | 2 | 3 | 5 |
| エルディンガー ヴァイスビア | 2 | 3 | 2 | 4 | 4 |
| ビットブルガー プレミアムピルス | 1 | 2 | 4 | 2 | 3 |
| ケストリッツァー シュヴァルツビア | 1 | 4 | 3 | 4 | 3 |
| パウラーナー ヘーフェヴァイスビア | 2 | 3 | 2 | 3 | 5 |
| シュパーテン ミュンヘナー ヘル | 1 | 2 | 3 | 3 | 2 |

---

## プロトタイプC: 味グラフ自動生成

### 機能概要

ビールのスペック情報（IBU、ABV、モルト種類など）を入力すると、味の傾向を推測してレーダーチャートを自動生成する機能です。

### 主要機能

| 機能 | 説明 |
|------|------|
| スペック入力 | ビール名、スタイル、ABV、IBU、モルト、発酵方法、特徴メモ |
| 味推測アルゴリズム | 入力値から5つの味覚スコアを自動計算 |
| チャート生成 | 計算結果をレーダーチャートで可視化 |

### 入力フィールド

| フィールド | 説明 | 例 |
|------------|------|-----|
| ビール名 | 表示用の名前 | Blue Moon |
| スタイル | ビアスタイル | IPA, Stout, Weizen |
| ABV | アルコール度数（%） | 5.5 |
| IBU | 苦味指数 | 45 |
| モルト | 主なモルトの種類 | caramel, munich |
| 発酵方法 | エール/ラガーなど | ale, lager |
| 特徴メモ | 風味の特徴 | banana, fruit, barrel |

### ユースケース

#### UC-C1: 新商品の味グラフを生成

**アクター**: 商品登録担当者

**事前条件**: ビールのスペック情報が判明している

**基本フロー**:
1. ビールのスペック情報を各フィールドに入力
2. 「チャート生成」ボタンをクリック
3. システムがスコア計算アルゴリズムを実行
4. 生成されたレーダーチャートを表示

**事後条件**: 推測された味グラフが表示される

#### UC-C2: スペック違いによる味の変化を確認

**アクター**: ビール愛好家

**基本フロー**:
1. あるビールのスペックを入力してチャート生成
2. 一部のスペック（例: IBU）を変更
3. 再度チャート生成
4. 味の変化を視覚的に比較

### 味推測アルゴリズム概要

各味覚スコアは以下のロジックで計算されます:

- **苦味**: IBU値を基準に5段階評価
- **甘味**: ABV + モルト種類 + スタイルから算出
- **コク**: ABV値を基準に5段階評価
- **香り**: 発酵方法 + スタイル + 特徴メモから算出
- **酸味**: スタイル（Sour系）+ 特徴メモから算出

---

## 共通仕様

### 味覚評価軸

全プロトタイプで共通の5軸を使用:

1. **酸味** (Sour)
2. **甘み** (Sweet)
3. **苦み** (Bitter)
4. **コク** (Body)
5. **香り** (Aroma)

### スコアレンジ

- 最小値: 0
- 最大値: 5
- 刻み幅: 0.5（マイテイスト登録）/ 1（その他）

### レーダーチャート仕様

- **ライブラリ**: Chart.js
- **チャートタイプ**: radar
- **カラースキーム**: 各プロトタイプで異なる配色
  - マイテイスト: ピンク系（rgba(255, 99, 132, x)）
  - 自動生成: シアン系（rgba(75, 192, 192, x)）

---

## 将来の拡張案

1. **マイテイスト連携**: プロトタイプA-Bの統合（保存したマイテイストで即座にマッチング）
2. **複数ビール比較**: 2-3種類のビールを同一チャート上で比較表示
3. **ビールDB拡充**: 実際の商品データベースとの連携
4. **SNS共有**: マイテイストグラフの画像生成・共有機能
5. **機械学習**: 実際の評価データによる味推測精度の向上
